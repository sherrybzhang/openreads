{% extends "base.html" %}

{% block head %}
<title>OpenReads</title>

{% endblock %}

{% block body %}
<header class="site-header">
  <div class="brand">
    <div class="brand-mark">OR</div>
    <div>
      <div class="brand-name">OpenReads</div>
      <p class="brand-tag">Reader profile</p>
    </div>
  </div>
  {% if current_user %}
    <div class="header-actions">
      <a class="profile-icon" href="{{ url_for('profile') }}" aria-label="Profile">
        {{ current_user.initials }}
      </a>
      <form action="/logout" method="POST">
        <button class="btn btn-ghost" type="submit">Logout</button>
      </form>
    </div>
  {% endif %}
</header>

<section class="grid-2">
  <div class="card" style="--delay: 0.05s;">
    <div class="profile-summary">
      <div class="profile-avatar" aria-hidden="true">{{ current_user.initials }}</div>
      <div class="profile-info">
        <h2>{{ current_user.username }}</h2>
        <p class="muted">Keep track of your reviews and reading momentum.</p>
      </div>
    </div>

    <div class="spec-grid">
      <div class="spec">
        <span class="spec-label">Reviews</span>
        <span>{{ review_total }}</span>
      </div>
      <div class="spec">
        <span class="spec-label">Avg Rating</span>
        <span>{{ ("%.1f" % average_rating) if average_rating is not none else "N/A" }}</span>
      </div>
      <div class="spec">
        <span class="spec-label">Shelf Status</span>
        <span>Active Reader</span>
      </div>
    </div>
  </div>

  <div class="card soft" style="--delay: 0.12s;">
    <h3>Recent Reviews</h3>
    {% if recent_reviews %}
      <div class="review-list">
        {% for review in recent_reviews %}
          <div class="spec">
            <strong>{{ review.title }}</strong>
            <div class="muted">{{ review.author }} Â· Rated {{ review.rating }} / 5</div>
            {% if review.review %}
              <p style="margin-top: 8px;">{{ review.review }}</p>
            {% endif %}
            {% if review.created_at %}
              <div class="muted" style="font-size: 0.85rem; margin-top: 8px;">{{ review.created_at }}</div>
            {% endif %}
          </div>
        {% endfor %}
      </div>
    {% else %}
      <p class="muted">No reviews yet. Head back to search to add your first review.</p>
    {% endif %}
  </div>
</section>
{% endblock %}
